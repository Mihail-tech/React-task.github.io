{"ast":null,"code":"import _regeneratorRuntime from\"/Users/itshatle/Desktop/rest/reac/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/itshatle/Desktop/rest/reac/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/itshatle/Desktop/rest/reac/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{authAPI}from\"../../api/api\";import{stopSubmit}from'redux-forms/lib/reducer';var SET_AUTH_USER_DATA='auth/SET_AUTH_USER_DATA';var initialState={userId:null,email:null,login:null,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_AUTH_USER_DATA:return _objectSpread(_objectSpread({},state),action.payload);default:return;}};export var setAuthUserData=function setAuthUserData(userId,email,login,isAuth){return{type:SET_AUTH_USER_DATA,payload:{userId:userId,email:email,login:login,isAuth:isAuth}};};export var getAuthUserData=function getAuthUserData(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response,_response$data$data,id,email,_login;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.me();case 2:response=_context.sent;if(response.data.resultCode===0){_response$data$data=response.data.data,id=_response$data$data.id,email=_response$data$data.email,_login=_response$data$data.login;dispatch(setAuthUserData(id,email,_login,true));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var login=function login(email,password,remember){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,messege;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authAPI.login(email,password,remember);case 2:response=_context2.sent;if(response.data.resultCode===0){dispatch(getAuthUserData());}else{messege=response.data.messages.length>0?response.data.messages[0]:\"error\";dispatch(stopSubmit('login',{_error:'Common error'}));}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return authAPI.logout();case 2:response=_context3.sent;if(response.data.resultCode===0){dispatch(setAuthUserData(null,null,null,false));}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default authReducer;","map":{"version":3,"sources":["/Users/itshatle/Desktop/rest/reac/src/components/redux/auth-reducer.js"],"names":["authAPI","stopSubmit","SET_AUTH_USER_DATA","initialState","userId","email","login","isAuth","authReducer","state","action","type","payload","setAuthUserData","getAuthUserData","dispatch","me","response","data","resultCode","id","password","remember","messege","messages","length","_error","logout"],"mappings":"ocAAA,OAASA,OAAT,KAAwB,eAAxB,CACA,OAAQC,UAAR,KAAyB,yBAAzB,CAEA,GAAMC,CAAAA,kBAAkB,CAAG,yBAA3B,CAGA,GAAIC,CAAAA,YAAY,CAAG,CAChBC,MAAM,CAAE,IADQ,CAEhBC,KAAK,CAAE,IAFS,CAGhBC,KAAK,CAAE,IAHS,CAIhBC,MAAM,CAAE,KAJQ,CAAnB,CAOA,GAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAkC,IAAjCC,CAAAA,KAAiC,2DAAzBN,YAAyB,IAAXO,CAAAA,MAAW,2CAClD,OAAOA,MAAM,CAACC,IAAd,EACI,IAAKT,CAAAA,kBAAL,CACI,sCACOO,KADP,EAEOC,MAAM,CAACE,OAFd,EAMR,QACI,OATJ,CAWH,CAZD,CAcA,MAAO,IAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACT,MAAD,CAASC,KAAT,CAAgBC,KAAhB,CAAuBC,MAAvB,QAC1B,CAACI,IAAI,CAAET,kBAAP,CAA2BU,OAAO,CAAC,CAACR,MAAM,CAANA,MAAD,CAASC,KAAK,CAALA,KAAT,CAAgBC,KAAK,CAALA,KAAhB,CAAuBC,MAAM,CAANA,MAAvB,CAAnC,CAD0B,EAAxB,CAGP,MAAO,IAAMO,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,kGAAM,iBAAOC,QAAP,yLACbf,CAAAA,OAAO,CAAEgB,EAAT,EADa,QAC9BC,QAD8B,eAG7B,GAAGA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAhC,CAAkC,qBACLF,QAAQ,CAACC,IAAT,CAAcA,IADT,CACzBE,EADyB,qBACzBA,EADyB,CACrBf,KADqB,qBACrBA,KADqB,CACdC,MADc,qBACdA,KADc,CAEhCS,QAAQ,CAACF,eAAe,CAACO,EAAD,CAAKf,KAAL,CAAYC,MAAZ,CAAmB,IAAnB,CAAhB,CAAR,CACD,CAN4B,sDAAN,gEAAxB,CAUP,MAAO,IAAMA,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACD,KAAD,CAAQgB,QAAR,CAAkBC,QAAlB,kGAA+B,kBAAOP,QAAP,kKAG3Bf,CAAAA,OAAO,CAAEM,KAAT,CAAeD,KAAf,CAAsBgB,QAAtB,CAAgCC,QAAhC,CAH2B,QAG5CL,QAH4C,gBAK5C,GAAGA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAhC,CAAkC,CAC/BJ,QAAQ,CAACD,eAAe,EAAhB,CAAR,CACF,CAFD,IAEO,CACCS,OADD,CACWN,QAAQ,CAACC,IAAT,CAAcM,QAAd,CAAuBC,MAAvB,CAAgC,CAAhC,CAAoCR,QAAQ,CAACC,IAAT,CAAcM,QAAd,CAAuB,CAAvB,CAApC,CAAgE,OAD3E,CAEHT,QAAQ,CAACd,UAAU,CAAC,OAAD,CAAU,CAACyB,MAAM,CAAE,cAAT,CAAV,CAAX,CAAR,CACH,CAV2C,wDAA/B,kEAAd,CAeP,MAAO,IAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,mGAAM,kBAAOZ,QAAP,0JACHf,CAAAA,OAAO,CAAE2B,MAAT,EADG,QACpBV,QADoB,gBAEpB,GAAGA,QAAQ,CAACC,IAAT,CAAcC,UAAd,GAA6B,CAAhC,CAAkC,CAC9BJ,QAAQ,CAACF,eAAe,CAAC,IAAD,CAAO,IAAP,CAAa,IAAb,CAAmB,KAAnB,CAAhB,CAAR,CACF,CAJkB,wDAAN,kEAAf,CAQP,cAAeL,CAAAA,WAAf","sourcesContent":["import { authAPI } from \"../../api/api\";\nimport {stopSubmit} from 'redux-forms/lib/reducer'\n\nconst SET_AUTH_USER_DATA = 'auth/SET_AUTH_USER_DATA';\n\n\nlet initialState = {\n   userId: null,\n   email: null,\n   login: null,\n   isAuth: false\n}\n\nconst authReducer = (state = initialState, action) => {\n    switch(action.type){\n        case SET_AUTH_USER_DATA:\n            return {\n                ...state, \n                ...action.payload,\n                  \n            }\n\n    default:\n        return\n    }\n}\n\nexport const setAuthUserData = (userId, email, login, isAuth) => \n    ({type: SET_AUTH_USER_DATA, payload:{userId, email, login, isAuth}});\n\nexport const getAuthUserData = () => async (dispatch) => {\n   let response = await authAPI .me()\n   \n        if(response.data.resultCode === 0){\n            let {id, email, login} = response.data.data;\n          dispatch(setAuthUserData(id, email, login, true));\n        }\n      \n}\n\nexport const login = (email, password, remember) => async (dispatch) => {\n   \n        \n    let response = await authAPI .login(email, password, remember);\n\n        if(response.data.resultCode === 0){\n           dispatch(getAuthUserData())\n        } else {\n            let messege = response.data.messages.length > 0 ? response.data.messages[0] : \"error\";\n            dispatch(stopSubmit('login', {_error: 'Common error'}));\n        }\n            \n     \n}\n\nexport const logout = () => async (dispatch) => {\n    let response = await authAPI .logout()\n        if(response.data.resultCode === 0){\n            dispatch(setAuthUserData(null, null, null, false));\n         }\n      \n}\n\nexport default authReducer;"]},"metadata":{},"sourceType":"module"}