{"ast":null,"code":"import _regeneratorRuntime from\"/Users/itshatle/Desktop/rest/reac/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/itshatle/Desktop/rest/reac/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _toConsumableArray from\"/Users/itshatle/Desktop/rest/reac/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/itshatle/Desktop/rest/reac/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{usersAPI}from\"../../api/api\";var FOLLOW='FOLLOW';var UNFOLLOW='UNFOLLOW';var SET_USERS='SET_USERS';var SET_CURRENT_PAGE='SET_CURRENT_PAGE';var SET_TOTAL_USERS_COUNT='SET_TOTAL_USERS_COUNT';var TOGGLE_IS_FETCHING='TOGGLE_IS_FETCHING';var TOGGLE_IS_FOLLOWING_PROGRESS='TOGGLE_IS_FOLLOWING_PROGRESS';var initialState={users:[],pageSize:10,totalUsersCount:0,//0\ncurrentPage:1,isFetching:false,followingInProgress:[]};var usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW:return _objectSpread(_objectSpread({},state),{},{users:state.users.map(function(users){if(users.id===action.userId){return _objectSpread(_objectSpread({},users),{},{followed:true});}return users;})});case UNFOLLOW:return _objectSpread(_objectSpread({},state),{},{users:state.users.map(function(users){if(users.id===action.userId){return _objectSpread(_objectSpread({},users),{},{followed:false});}return users;})});case SET_USERS:return _objectSpread(_objectSpread({},state),{},{users:action.users});case SET_CURRENT_PAGE:return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});case SET_TOTAL_USERS_COUNT:return _objectSpread(_objectSpread({},state),{},{totalUsersCount:action.totalUsersCount});case TOGGLE_IS_FETCHING:return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});case TOGGLE_IS_FOLLOWING_PROGRESS:return _objectSpread(_objectSpread({},state),{},{followingInProgress:action.isFetching?[].concat(_toConsumableArray(state.followingInProgress),[action.userId]):state.followingInProgress.filter(function(id){return id!==action.userId;})});default:return;}};export var followSuccess=function followSuccess(userId){return{type:FOLLOW,userId:userId};};export var unfollowSuccess=function unfollowSuccess(userId){return{type:UNFOLLOW,userId:userId};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setTotalUsersCount=function setTotalUsersCount(totalUsersCount){return{type:SET_TOTAL_USERS_COUNT,totalUsersCount:totalUsersCount};};export var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};export var toggleFollowingProgress=function toggleFollowingProgress(isFetching,userId){return{type:TOGGLE_IS_FOLLOWING_PROGRESS,isFetching:isFetching,userId:userId};};export var requestUsers=function requestUsers(page,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggleIsFetching(true));dispatch(setCurrentPage(page));_context.next=4;return usersAPI.getUsers(page,pageSize);case 4:data=_context.sent;dispatch(toggleIsFetching(false));dispatch(setUsers(data.items));dispatch(setTotalUsersCount(data.totalCount));case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var follow=function follow(userId){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context2.next=3;return usersAPI.follow(userId);case 3:response=_context2.sent;if(response.data.resultCode===0){dispatch(followSuccess(userId));}dispatch(toggleFollowingProgress(false,userId));case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var unfollow=function unfollow(userId){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(toggleFollowingProgress(true,userId));_context3.next=3;return usersAPI.unfollow(userId);case 3:response=_context3.sent;if(response.data.resultCode===0){dispatch(unfollowSuccess(userId));}dispatch(toggleFollowingProgress(false,userId));case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default usersReducer;","map":{"version":3,"sources":["/Users/itshatle/Desktop/rest/reac/src/components/redux/users-reducer.js"],"names":["usersAPI","FOLLOW","UNFOLLOW","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","TOGGLE_IS_FETCHING","TOGGLE_IS_FOLLOWING_PROGRESS","initialState","users","pageSize","totalUsersCount","currentPage","isFetching","followingInProgress","usersReducer","state","action","type","map","id","userId","followed","filter","followSuccess","unfollowSuccess","setUsers","setCurrentPage","setTotalUsersCount","toggleIsFetching","toggleFollowingProgress","requestUsers","page","dispatch","getUsers","data","items","totalCount","follow","response","resultCode","unfollow"],"mappings":"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","sourcesContent":["import { usersAPI } from \"../../api/api\";\n\nconst FOLLOW = 'FOLLOW';\nconst UNFOLLOW = 'UNFOLLOW';\nconst SET_USERS = 'SET_USERS';\nconst SET_CURRENT_PAGE = 'SET_CURRENT_PAGE';\nconst SET_TOTAL_USERS_COUNT = 'SET_TOTAL_USERS_COUNT';\nconst TOGGLE_IS_FETCHING = 'TOGGLE_IS_FETCHING';\nconst TOGGLE_IS_FOLLOWING_PROGRESS = 'TOGGLE_IS_FOLLOWING_PROGRESS';\n\n\nlet initialState = {\n   users: [ ],\n   pageSize: 10,\n   totalUsersCount: 0, //0\n   currentPage: 1,\n   isFetching: false,\n   followingInProgress: []\n}\n\nconst usersReducer = (state = initialState, action) => {\n    switch(action.type){\n        case FOLLOW:\n            return {\n                ...state, \n                users: state.users.map(users => {\n                    if(users.id === action.userId) {\n                        return {...users, followed: true}\n                    }\n                    return users\n                })\n            }\n\n        case UNFOLLOW:\n            return {\n                ...state, \n                users: state.users.map(users => {\n                    if(users.id === action.userId) {\n                        return {...users, followed: false}\n                    }\n                    return users\n                })\n            }\n        \n        case SET_USERS: \n        return {\n            ...state, \n            users: action.users\n        }\n        case SET_CURRENT_PAGE:\n            return {\n                ...state,\n                currentPage: action.currentPage\n            }\n        case SET_TOTAL_USERS_COUNT:\n            return {\n                ...state,\n                totalUsersCount: action.totalUsersCount\n            }\n        case TOGGLE_IS_FETCHING:\n            return {\n                ...state,\n                isFetching: action.isFetching\n            }\n        case TOGGLE_IS_FOLLOWING_PROGRESS:\n            return {\n                ...state,\n                followingInProgress: action.isFetching ? \n                [...state.followingInProgress, action.userId] \n                : state.followingInProgress.filter(id=> id !== action.userId)\n            }\n\n    default:\n        return\n    }\n}\n\nexport const followSuccess = (userId) => ({type: FOLLOW, userId});\nexport const unfollowSuccess= (userId) => ({type: UNFOLLOW, userId});\nexport const setUsers = (users) => ({type:SET_USERS, users});\nexport const setCurrentPage = (currentPage) => ({type:SET_CURRENT_PAGE, currentPage});\nexport const setTotalUsersCount = (totalUsersCount) => ({type:SET_TOTAL_USERS_COUNT, totalUsersCount})\nexport const toggleIsFetching = (isFetching) => ({type: TOGGLE_IS_FETCHING, isFetching});\nexport const toggleFollowingProgress = (isFetching, userId) => ({type: TOGGLE_IS_FOLLOWING_PROGRESS, isFetching, userId});\n\nexport const requestUsers = (page, pageSize) => {\n    return async (dispatch) => {\n\n        dispatch(toggleIsFetching(true));\n        dispatch(setCurrentPage(page))\n\n           let data = await usersAPI.getUsers(page, pageSize)\n\n                dispatch(toggleIsFetching(false))   \n                dispatch(setUsers(data.items));\n                dispatch(setTotalUsersCount(data.totalCount));\n            \n    }\n}\n\nexport const follow = (userId) => {\n    return async (dispatch) => {\n\n        dispatch(toggleFollowingProgress(true, userId));\n\n        let response = await usersAPI.follow(userId)\n            if(response.data.resultCode === 0) {\n                dispatch(followSuccess(userId))\n            }\n        dispatch(toggleFollowingProgress(false, userId));\n        \n    }\n}\n\nexport const unfollow = (userId) => {\n    return async (dispatch) => {\n\n        dispatch(toggleFollowingProgress(true, userId));\n\n        let response = await usersAPI.unfollow(userId)\n            if(response.data.resultCode === 0) {\n                dispatch(unfollowSuccess(userId))\n            }\n            dispatch(toggleFollowingProgress(false, userId));\n        \n    }\n}\n\n\nexport default usersReducer;"]},"metadata":{},"sourceType":"module"}